{"ast":null,"code":"import { deleteRequest, getRequest, postRequest, putRequest } from \"../../api/api\";\nimport { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport { getItem, setItem } from \"../../utils/storage.utils\";\nexport const signUp = (redirect, form) => async (dispatch, getState) => {\n  const loading = getState().user.loading;\n  if (loading) return;\n  dispatch(startLoading());\n  const {\n    status,\n    result,\n    error\n  } = await postRequest(`/users/sign-up`, form);\n  if (error) {\n    const message = `Erreur: ${error}`;\n    return message;\n  }\n  if (status >= 200 && status < 300) {\n    setItem(\"token\", result.token);\n    console.log(result.token);\n    redirect();\n  }\n  dispatch(stopLoading());\n};\nexport const signIn = (redirect, form) => async (dispatch, getState) => {\n  const loading = getState().user.loading;\n  if (loading) return;\n  dispatch(startLoading());\n  const {\n    status,\n    result,\n    error\n  } = await postRequest(`/users/sign-in`, form);\n  if (error) {\n    const message = `Erreur: ${error}`;\n    return message;\n  }\n  if (status >= 200 && status < 300) {\n    setItem(\"token\", result.token);\n    setItem(\"userId\", result.user.id);\n    redirect();\n  }\n  dispatch(stopLoading());\n};\nexport const modifyUser = createAsyncThunk(\"user/modifyUser\", async (_ref, thunkApi) => {\n  let {\n    userId,\n    name,\n    firstname,\n    email,\n    number\n  } = _ref;\n  const token = getItem(\"token\");\n  const {\n    fulfillWithValue,\n    rejectWithValue\n  } = thunkApi;\n  const {\n    status,\n    result,\n    error\n  } = await putRequest(`/users/update/${userId}`, {\n    name,\n    firstname,\n    email,\n    number\n  }, token);\n  return error ? rejectWithValue(`Cannot get user - Error status ${status} - ${error}`) : fulfillWithValue(result);\n});\nexport const getOneUser = createAsyncThunk(\"users/getOne\", async (userId, thunkApi) => {\n  const token = getItem(\"token\");\n  const {\n    fulfillWithValue,\n    rejectWithValue\n  } = thunkApi;\n  const {\n    status,\n    result,\n    error\n  } = await getRequest(`/users/${userId}`, token);\n  return error ? rejectWithValue(`Cannot get user - Error status ${status} - ${error}`) : fulfillWithValue(result);\n});\nexport const deleteUser = createAsyncThunk(\"users/deleteGame\", async (userId, thunkApi) => {\n  const token = getItem(\"token\");\n  const {\n    fulfillWithValue,\n    rejectWithValue\n  } = thunkApi;\n  const {\n    status,\n    result,\n    error\n  } = await deleteRequest(`/users/delete/${userId}`, token);\n  return error ? rejectWithValue(`Cannot get user - Error status ${status} - ${error}`) : fulfillWithValue({\n    result\n  });\n});\nexport const userSlice = createSlice({\n  name: \"user\",\n  initialState: {\n    user: [],\n    name: \"\",\n    firstname: \"\",\n    email: \"\",\n    number: 0,\n    password: \"\",\n    loading: false\n  },\n  reducers: {\n    startLoading: state => {\n      return {\n        ...state,\n        loading: true\n      };\n    },\n    stopLoading: state => {\n      return {\n        ...state,\n        loading: false\n      };\n    },\n    updateUser: (state, action) => {\n      const {\n        key,\n        value\n      } = action.payload;\n      return {\n        ...state,\n        [key]: value\n      };\n      // state[key] = value;\n    }\n  },\n\n  extraReducers: builder => {\n    builder.addCase(getOneUser.fulfilled, (state, action) => {\n      return {\n        ...state,\n        loading: false,\n        user: action.payload.user\n      };\n    }).addCase(getOneUser.rejected, (state, action) => {\n      return {\n        ...state,\n        loading: false,\n        error: action.payload\n      };\n    }).addCase(getOneUser.pending, (state, action) => {\n      return {\n        ...state,\n        loading: true\n      };\n    }).addCase(modifyUser.fulfilled, (state, action) => {\n      const updatedUser = action.payload.user;\n      const updatedUsers = Array.isArray(state.user) ? state.user.map(u => u.id === updatedUser.id ? updatedUser : u) : [];\n      return {\n        ...state,\n        loading: false,\n        user: updatedUsers\n      };\n    }).addCase(modifyUser.rejected, (state, action) => {\n      return {\n        ...state,\n        loading: false,\n        error: action.payload\n      };\n    }).addCase(modifyUser.pending, (state, action) => {\n      return {\n        ...state,\n        loading: true\n      };\n    }).addCase(deleteUser.fulfilled, (state, action) => {\n      const {\n        id\n      } = action.payload;\n      return {\n        ...state,\n        loading: false,\n        user: state.user.filter(user => user.id !== id)\n      };\n    }).addCase(deleteUser.rejected, (state, action) => {\n      return {\n        ...state,\n        loading: false,\n        error: action.payload\n      };\n    }).addCase(deleteUser.pending, (state, action) => {\n      return {\n        ...state,\n        loading: true\n      };\n    });\n  }\n});\nexport const {\n  startLoading,\n  stopLoading,\n  updateUser\n} = userSlice.actions;\nexport default userSlice.reducer;","map":{"version":3,"names":["deleteRequest","getRequest","postRequest","putRequest","createAsyncThunk","createSlice","getItem","setItem","signUp","redirect","form","dispatch","getState","loading","user","startLoading","status","result","error","message","token","console","log","stopLoading","signIn","id","modifyUser","thunkApi","userId","name","firstname","email","number","fulfillWithValue","rejectWithValue","getOneUser","deleteUser","userSlice","initialState","password","reducers","state","updateUser","action","key","value","payload","extraReducers","builder","addCase","fulfilled","rejected","pending","updatedUser","updatedUsers","Array","isArray","map","u","filter","actions","reducer"],"sources":["/Users/watsonandrew/Desktop/scoreUp/react/src/redux/reducers/user.slice.js"],"sourcesContent":["import {\n  deleteRequest,\n  getRequest,\n  postRequest,\n  putRequest,\n} from \"../../api/api\";\nimport { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport { getItem, setItem } from \"../../utils/storage.utils\";\n\nexport const signUp = (redirect, form) => async (dispatch, getState) => {\n  const loading = getState().user.loading;\n  if (loading) return;\n  dispatch(startLoading());\n  const { status, result, error } = await postRequest(`/users/sign-up`, form);\n  if (error) {\n    const message = `Erreur: ${error}`;\n    return message;\n  }\n  if (status >= 200 && status < 300) {\n    setItem(\"token\", result.token);\n    console.log(result.token);\n    redirect();\n  }\n  dispatch(stopLoading());\n};\n\nexport const signIn = (redirect, form) => async (dispatch, getState) => {\n  const loading = getState().user.loading;\n  if (loading) return;\n  dispatch(startLoading());\n  const { status, result, error } = await postRequest(`/users/sign-in`, form);\n  if (error) {\n    const message = `Erreur: ${error}`;\n    return message;\n  }\n  if (status >= 200 && status < 300) {\n    setItem(\"token\", result.token);\n    setItem(\"userId\", result.user.id);\n    redirect();\n  }\n  dispatch(stopLoading());\n};\n\nexport const modifyUser = createAsyncThunk(\n  \"user/modifyUser\",\n  async ({ userId, name, firstname, email, number }, thunkApi) => {\n    const token = getItem(\"token\");\n    const { fulfillWithValue, rejectWithValue } = thunkApi;\n    const { status, result, error } = await putRequest(\n      `/users/update/${userId}`,\n      { name, firstname, email, number },\n      token,\n    );\n    return error\n      ? rejectWithValue(`Cannot get user - Error status ${status} - ${error}`)\n      : fulfillWithValue(result);\n  },\n);\n\nexport const getOneUser = createAsyncThunk(\n  \"users/getOne\",\n  async (userId, thunkApi) => {\n    const token = getItem(\"token\");\n    const { fulfillWithValue, rejectWithValue } = thunkApi;\n    const { status, result, error } = await getRequest(\n      `/users/${userId}`,\n      token,\n    );\n    return error\n      ? rejectWithValue(`Cannot get user - Error status ${status} - ${error}`)\n      : fulfillWithValue(result);\n  },\n);\n\nexport const deleteUser = createAsyncThunk(\n  \"users/deleteGame\",\n  async (userId, thunkApi) => {\n    const token = getItem(\"token\");\n    const { fulfillWithValue, rejectWithValue } = thunkApi;\n    const { status, result, error } = await deleteRequest(\n      `/users/delete/${userId}`,\n      token,\n    );\n    return error\n      ? rejectWithValue(`Cannot get user - Error status ${status} - ${error}`)\n      : fulfillWithValue({ result });\n  },\n);\n\nexport const userSlice = createSlice({\n  name: \"user\",\n  initialState: {\n    user: [],\n    name: \"\",\n    firstname: \"\",\n    email: \"\",\n    number: 0,\n    password: \"\",\n    loading: false,\n  },\n  reducers: {\n    startLoading: (state) => {\n      return { ...state, loading: true };\n    },\n    stopLoading: (state) => {\n      return { ...state, loading: false };\n    },\n    updateUser: (state, action) => {\n      const { key, value } = action.payload;\n      return { ...state, [key]: value };\n      // state[key] = value;\n    },\n  },\n  extraReducers: (builder) => {\n    builder\n      .addCase(getOneUser.fulfilled, (state, action) => {\n        return { ...state, loading: false, user: action.payload.user };\n      })\n      .addCase(getOneUser.rejected, (state, action) => {\n        return { ...state, loading: false, error: action.payload };\n      })\n      .addCase(getOneUser.pending, (state, action) => {\n        return { ...state, loading: true };\n      })\n      .addCase(modifyUser.fulfilled, (state, action) => {\n        const updatedUser = action.payload.user;\n        const updatedUsers = Array.isArray(state.user)\n          ? state.user.map((u) => (u.id === updatedUser.id ? updatedUser : u))\n          : [];\n        return {\n          ...state,\n          loading: false,\n          user: updatedUsers,\n        };\n      })\n\n      .addCase(modifyUser.rejected, (state, action) => {\n        return { ...state, loading: false, error: action.payload };\n      })\n      .addCase(modifyUser.pending, (state, action) => {\n        return { ...state, loading: true };\n      })\n      .addCase(deleteUser.fulfilled, (state, action) => {\n        const { id } = action.payload;\n        return {\n          ...state,\n          loading: false,\n          user: state.user.filter((user) => user.id !== id),\n        };\n      })\n      .addCase(deleteUser.rejected, (state, action) => {\n        return { ...state, loading: false, error: action.payload };\n      })\n      .addCase(deleteUser.pending, (state, action) => {\n        return { ...state, loading: true };\n      });\n  },\n});\n\nexport const { startLoading, stopLoading, updateUser } = userSlice.actions;\nexport default userSlice.reducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}